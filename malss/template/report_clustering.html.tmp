<html>

<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<title>Analysis report</title>
</head>

<body>
	<h1 id="top">Results</h1>

	<table border="1" cellspacing="0" cellpadding="5">
		<tr>
			<th rowspan=2>Algorithms</th>
			<th colspan=4>Estimated number of clusters</th>
		</th>
		<tr>
			<th>Gap statistic</th>
			<th>Silhouette score</th>
			<th>Davies-Bouldin score</th>
			<th>Calinski and Harabasz score</th>
		</tr>

	{%- for algorithm in algorithms %}
		<tr>
			<td><a href="#{{ algorithm.name }}">{{ algorithm.name }}</a></td>
			<td>{{ algorithm.results['gap_nc'] }}</td>
			<td>{{ algorithm.results['silhouette_nc'] }}</td>
			<td>{{ algorithm.results['davies_nc'] }}</td>
			<td>{{ algorithm.results['calinski_nc'] }}</td>
		</tr>
	{%- endfor %}
	</table>
	<p>
	According to the majority rule, the estimated number of clusters is <strong>{{ nc }}</strong>.
	</p>
	<br>

	<h2>Clustering <font size="-1">[<a href="#top">Back To Top</a>]</font></h2>
	<p>
		<ul>
			<li>クラスタリングは一般的に正解が与えられない（教師なし学習）ため，人が分析結果の妥当性を判断する必要があります．</li>
			<li>多くのクラスタリングアルゴリズム（MALSSが採用するものも）は，想定されるクラスタ数を人が設定してやる必要があります．しかし，真のクラスタ数は一般に未知です．そこでMALSSでは，あらかじめ与えられた複数のクラスタ数候補に対して分析を行います．</li>
			<li>適切なクラスタ数を判断する様々な指標が提案されています．MALSSでは，<strong>複数の指標から多数決でクラスタ数を推定</strong>します．</li>
			<li>MALSSがクラスタ数の判断に用いる指標は，Gap統計量，Silhouetteスコア，Davies-Bouldinスコア，Calinski and Harabaszスコアの４つです．</li>
		</ul>
	</p>
	<hr>

	<h2>Data summary <font size="-1">[<a href="#top">Back To Top</a>]</font></h2>
	<ul>
		<li>Number of rows: {{ data.shape_before[0] }}</li>
		<li>Number of columns: {{ data.shape_before[1] }} (numerical: {{ data.shape_before[1] - data.del_columns|length }}, categorical: {{ data.del_columns|length }})</li>
		{%- if data.del_columns|length > 0 %}
		<ul>
			<li>Categorical values were encoded to integer features using a <a href="http://scikit-learn.org/stable/modules/preprocessing.html#encoding-categorical-features">one-of-K scheme</a>.</li>
		</ul>
		{%- endif %}
		{%- if data.col_was_null|length > 0 %}
		<li>Column {% for col in data.col_was_null %}{{ col }} {% endfor %}had NA values.</li>
		<ul>
			<li>NA values were filled in with the most frequent value (categorical), median (integer), mean (float).</li>
			<li>See also: <a href="http://pandas.pydata.org/pandas-docs/stable/missing_data.html">missing data</a></li>
		</ul>
		{%- endif %}
	</ul>
	<details>
	<summary><font size="+1"><strong>Descriptions (click here)</strong></font></summary>
	<ul>
		<li>クラスタリングはサンプル間の距離をみることが多いため，特徴量ごとの大きさが大きく異なっている（例えば特徴量１は身長[m]で1桁のオーダー，特徴量２は体重[g]で5桁のオーダー）と上手くクラスタリングできないことがあります（数値の小さい身長の影響が無視されてしまう）．<br>そこで，MALSSの初期設定では各特徴量を平均が0，分散が1になるように<strong>標準化</strong>しています．標準化が不要な場合は，コンストラクタの引数を <i>standardize=False</i> にしてください．</li>
		<li>数値データであってもカテゴリ型として扱わなければいけない変数（例えば市区町村コードなど）もあるので注意してください．この場合，<a href="http://www.weblio.jp/content/%E3%83%80%E3%83%9F%E3%83%BC%E5%A4%89%E6%95%B0">ダミー変数</a>を用いて事前にデータ変換をしておく必要があります．</li>
	</ul>
	</details>
	<hr>

	<h2 id="{{ algorithms[0].name }}"><a href="{{ algorithms[0].link }}">k-means clustering</a> <font size="-1">[<a href="#top">Back To Top</a>]</font></h2>
	<p>
		<ul>
			<li>k-meansクラスタリングは最もポピュラーなクラスタリングアルゴリズムの１つです．</li>
			<li>k-meansクラスタリングは，<strong>各クラスタのサイズが同じである</strong>ことを仮定していることに注意が必要です．この仮定が妥当でないデータにk-meansクラスタリングを適用した場合，望ましいクラスタリング結果が得られない可能性があります．</li>
		</ul>
	</p>

	<h3>Gap statistics</h3>
	<img border="0" src="gap_{{ algorithms[0].estimator.__class__.__name__ }}.png" height="300" alt="gap_statistics">

	<h3>Silhouette score</h3>
	<img border="0" src="silhouette_{{ algorithms[0].estimator.__class__.__name__ }}.png" height="300" alt="silhouette_score">
    
	<h3>Davies-Bouldin score</h3>
	<img border="0" src="davies_{{ algorithms[0].estimator.__class__.__name__ }}.png" height="300" alt="davies_bouldin_score">
    
	<h3>Calinski and Harabasz score</h3>
	<img border="0" src="calinski_{{ algorithms[0].estimator.__class__.__name__ }}.png" height="300" alt="calinski_harabasz_score">
    
	<h2 id="{{ algorithms[1].name }}"><a href="{{ algorithms[1].link }}">Hierarchical clustering</a> <font size="-1">[<a href="#top">Back To Top</a>]</font></h2>

	<h3>Dendrogram</h3>
	<img border="0" src="dendrogram_{{ algorithms[1].estimator.__class__.__name__ }}.png" height="400" alt="dendrogram">

	<h3>Gap statistics</h3>
	<img border="0" src="gap_{{ algorithms[1].estimator.__class__.__name__ }}.png" height="300" alt="gap_statistics">

	<h3>Silhouette score</h3>
	<img border="0" src="silhouette_{{ algorithms[1].estimator.__class__.__name__ }}.png" height="300" alt="silhouette_score">
    
	<h3>Davies-Bouldin score</h3>
	<img border="0" src="davies_{{ algorithms[1].estimator.__class__.__name__ }}.png" height="300" alt="davies_bouldin_score">
    
	<h3>Calinski and Harabasz score</h3>
	<img border="0" src="calinski_{{ algorithms[1].estimator.__class__.__name__ }}.png" height="300" alt="calinski_harabasz_score">
    
</body>
</html>